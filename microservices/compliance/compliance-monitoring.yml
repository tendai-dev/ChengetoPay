# Compliance Monitoring Configuration for Financial Platform
# Real-time compliance monitoring and reporting

# Compliance Framework
compliance_framework:
  # PCI DSS
  pci_dss:
    enabled: true
    version: "4.0"
    requirements:
      - requirement: "3"
        description: "Protect stored cardholder data"
        controls: ["data_encryption", "key_management", "data_retention"]
      - requirement: "4"
        description: "Encrypt transmission of cardholder data"
        controls: ["tls_encryption", "secure_protocols"]
      - requirement: "7"
        description: "Restrict access to cardholder data"
        controls: ["access_controls", "user_management"]
      - requirement: "10"
        description: "Log and monitor all access"
        controls: ["audit_logging", "log_monitoring"]

  # SOX
  sox:
    enabled: true
    sections:
      - section: "302"
        description: "Corporate Responsibility for Financial Reports"
        controls: ["financial_accuracy", "internal_controls"]
      - section: "404"
        description: "Management Assessment of Internal Controls"
        controls: ["control_framework", "control_testing"]

  # GDPR
  gdpr:
    enabled: true
    articles:
      - article: "5"
        description: "Principles of Processing"
        controls: ["lawful_processing", "data_minimization"]
      - article: "32"
        description: "Security of Processing"
        controls: ["security_measures", "breach_detection"]

  # AML
  aml:
    enabled: true
    requirements:
      - requirement: "customer_due_diligence"
        description: "Customer Due Diligence"
        controls: ["customer_identification", "risk_assessment"]
      - requirement: "suspicious_activity_reporting"
        description: "Suspicious Activity Reporting"
        controls: ["suspicious_detection", "sar_filing"]

# Compliance Monitoring
compliance_monitoring:
  # Real-time Monitoring
  real_time_monitoring:
    enabled: true
    monitoring_rules:
      # PCI DSS Monitoring
      pci_dss_rules:
        - name: "CardDataAccess"
          description: "Monitor access to cardholder data"
          condition: "access_to_card_data"
          severity: "critical"
        - name: "EncryptionStatus"
          description: "Monitor encryption status"
          condition: "encryption_disabled"
          severity: "critical"

      # SOX Monitoring
      sox_rules:
        - name: "FinancialDataChanges"
          description: "Monitor changes to financial data"
          condition: "financial_data_modified"
          severity: "critical"
        - name: "SystemAccess"
          description: "Monitor system access"
          condition: "privileged_access"
          severity: "warning"

      # GDPR Monitoring
      gdpr_rules:
        - name: "DataBreach"
          description: "Monitor potential data breaches"
          condition: "potential_data_breach"
          severity: "critical"
        - name: "DataSubjectRequests"
          description: "Monitor data subject requests"
          condition: "data_subject_request_received"
          severity: "info"

      # AML Monitoring
      aml_rules:
        - name: "SuspiciousTransactions"
          description: "Monitor suspicious transactions"
          condition: "suspicious_transaction_detected"
          severity: "critical"
        - name: "HighValueTransactions"
          description: "Monitor high-value transactions"
          condition: "transaction_amount > 10000"
          severity: "warning"

  # Compliance Reporting
  compliance_reporting:
    enabled: true
    automated_reports:
      # Daily Reports
      daily_reports:
        - name: "PCIComplianceDaily"
          description: "Daily PCI DSS compliance report"
          schedule: "0 6 * * *"
          recipients: ["compliance@financialplatform.com"]
        - name: "SOXComplianceDaily"
          description: "Daily SOX compliance report"
          schedule: "0 7 * * *"
          recipients: ["compliance@financialplatform.com"]
        - name: "GDPRComplianceDaily"
          description: "Daily GDPR compliance report"
          schedule: "0 8 * * *"
          recipients: ["compliance@financialplatform.com"]

      # Weekly Reports
      weekly_reports:
        - name: "ComplianceSummaryWeekly"
          description: "Weekly compliance summary"
          schedule: "0 10 * * 0"
          recipients: ["compliance@financialplatform.com", "cto@financialplatform.com"]

      # Monthly Reports
      monthly_reports:
        - name: "ComplianceAuditMonthly"
          description: "Monthly compliance audit"
          schedule: "0 12 1 * *"
          recipients: ["compliance@financialplatform.com", "legal@financialplatform.com"]

# Compliance Testing
compliance_testing:
  # Automated Testing
  automated_testing:
    enabled: true
    test_schedules:
      # Daily Tests
      daily_tests:
        - name: "PCIComplianceTest"
          description: "Daily PCI DSS compliance test"
          schedule: "0 2 * * *"
        - name: "SOXComplianceTest"
          description: "Daily SOX compliance test"
          schedule: "0 3 * * *"
        - name: "GDPRComplianceTest"
          description: "Daily GDPR compliance test"
          schedule: "0 4 * * *"

      # Weekly Tests
      weekly_tests:
        - name: "ComprehensiveComplianceTest"
          description: "Weekly comprehensive compliance test"
          schedule: "0 6 * * 0"

      # Monthly Tests
      monthly_tests:
        - name: "FullComplianceAudit"
          description: "Monthly full compliance audit"
          schedule: "0 8 1 * *"

# Compliance Alerts
compliance_alerts:
  # Alert Configuration
  alert_configuration:
    enabled: true
    alert_channels:
      - name: "slack"
        channel: "#compliance-alerts"
        enabled: true
      - name: "email"
        recipients: ["compliance@financialplatform.com"]
        enabled: true
      - name: "pagerduty"
        service: "compliance-service"
        enabled: true

    # Alert Rules
    alert_rules:
      # Critical Alerts
      critical_alerts:
        - name: "ComplianceViolation"
          description: "Critical compliance violation detected"
          condition: "compliance_violation"
          severity: "critical"
          channels: ["slack", "email", "pagerduty"]
        - name: "DataBreach"
          description: "Potential data breach detected"
          condition: "data_breach_detected"
          severity: "critical"
          channels: ["slack", "email", "pagerduty"]

      # Warning Alerts
      warning_alerts:
        - name: "ComplianceWarning"
          description: "Compliance warning detected"
          condition: "compliance_warning"
          severity: "warning"
          channels: ["slack", "email"]
        - name: "SuspiciousActivity"
          description: "Suspicious activity detected"
          condition: "suspicious_activity"
          severity: "warning"
          channels: ["slack", "email"]

# Compliance Dashboard
compliance_dashboard:
  # Dashboard Configuration
  dashboard_configuration:
    enabled: true
    provider: "grafana"
    refresh_interval: "30 seconds"
    
    # Dashboard Panels
    dashboard_panels:
      # Compliance Status
      compliance_status:
        - name: "PCIComplianceStatus"
          description: "PCI DSS compliance status"
          type: "stat"
          query: "pci_compliance_score"
        - name: "SOXComplianceStatus"
          description: "SOX compliance status"
          type: "stat"
          query: "sox_compliance_score"
        - name: "GDPRComplianceStatus"
          description: "GDPR compliance status"
          type: "stat"
          query: "gdpr_compliance_score"

      # Compliance Metrics
      compliance_metrics:
        - name: "ComplianceViolations"
          description: "Number of compliance violations"
          type: "timeseries"
          query: "compliance_violations_total"
        - name: "DataBreaches"
          description: "Number of data breaches"
          type: "timeseries"
          query: "data_breaches_total"

# Compliance Documentation
compliance_documentation:
  # Policy Documentation
  policy_documentation:
    - name: "CompliancePolicy"
      description: "Overall compliance policy"
      version: "1.0"
      last_updated: "2024-01-01"
    - name: "PCICompliancePolicy"
      description: "PCI DSS compliance policy"
      version: "1.0"
      last_updated: "2024-01-01"
    - name: "SOXCompliancePolicy"
      description: "SOX compliance policy"
      version: "1.0"
      last_updated: "2024-01-01"
    - name: "GDPRCompliancePolicy"
      description: "GDPR compliance policy"
      version: "1.0"
      last_updated: "2024-01-01"

  # Procedure Documentation
  procedure_documentation:
    - name: "IncidentResponseProcedure"
      description: "Compliance incident response procedure"
      version: "1.0"
      last_updated: "2024-01-01"
    - name: "AuditProcedure"
      description: "Compliance audit procedure"
      version: "1.0"
      last_updated: "2024-01-01"
    - name: "ReportingProcedure"
      description: "Compliance reporting procedure"
      version: "1.0"
      last_updated: "2024-01-01"
